(function(e){function t(t){for(var r,a,c=t[0],l=t[1],s=t[2],u=0,d=[];u<c.length;u++)a=c[u],o[a]&&d.push(o[a][0]),o[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(e[r]=l[r]);f&&f(t);while(d.length)d.shift()();return i.push.apply(i,s||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],r=!0,a=1;a<n.length;a++){var l=n[a];0!==o[l]&&(r=!1)}r&&(i.splice(t--,1),e=c(c.s=n[0]))}return e}var r={},o={app:0},i=[];function a(e){return c.p+"static/js/"+({about:"about"}[e]||e)+"."+{about:"a807c8cf"}[e]+".js"}function c(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(e){var t=[],n=o[e];if(0!==n)if(n)t.push(n[2]);else{var r=new Promise(function(t,r){n=o[e]=[t,r]});t.push(n[2]=r);var i,l=document.createElement("script");l.charset="utf-8",l.timeout=120,c.nc&&l.setAttribute("nonce",c.nc),l.src=a(e),i=function(t){l.onerror=l.onload=null,clearTimeout(s);var n=o[e];if(0!==n){if(n){var r=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,a=new Error("Loading chunk "+e+" failed.\n("+r+": "+i+")");a.type=r,a.request=i,n[1](a)}o[e]=void 0}};var s=setTimeout(function(){i({type:"timeout",target:l})},12e4);l.onerror=l.onload=i,document.head.appendChild(l)}return Promise.all(t)},c.m=e,c.c=r,c.d=function(e,t,n){c.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},c.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,t){if(1&t&&(e=c(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)c.d(n,r,function(t){return e[t]}.bind(null,r));return n},c.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return c.d(t,"a",t),t},c.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},c.p="/",c.oe=function(e){throw console.error(e),e};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],s=l.push.bind(l);l.push=t,l=l.slice();for(var u=0;u<l.length;u++)t(l[u]);var f=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"034f":function(e,t,n){"use strict";var r=n("64a9"),o=n.n(r);o.a},1070:function(e,t,n){},"51b9":function(e,t,n){"use strict";var r=n("7978"),o=n.n(r);o.a},"56d7":function(e,t,n){"use strict";n.r(t);n("cadf"),n("551c"),n("097d");var r=n("2b0e"),o=n("d847"),i=n.n(o),a=n("795b"),c=n.n(a),l=n("bc3a"),s=n.n(l),u={baseURL:Object({VUE_APP_CLI_UI_URL:"",NODE_ENV:"production",BASE_URL:"/"}).baseURL||Object({VUE_APP_CLI_UI_URL:"",NODE_ENV:"production",BASE_URL:"/"}).apiUrl||"",timeout:6e4},f=s.a.create(u);f.interceptors.request.use(function(e){return e},function(e){return c.a.reject(e)}),f.interceptors.response.use(function(e){return e},function(e){return c.a.reject(e)}),Plugin.install=function(e){e.axios=f,window.axios=f,i()(e.prototype,{axios:{get:function(){return f}},$axios:{get:function(){return f}}})},r["default"].use(Plugin);Plugin;var d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},p=[],m=(n("034f"),n("2877")),h={},b=Object(m["a"])(h,d,p,!1,null,null,null),v=b.exports,g=n("5c96"),w=n.n(g);n("0fae");r["default"].use(w.a);var y=n("8c4f"),S=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",{staticClass:"header"},[e._v("Adbs")]),n("el-main",[n("el-row",[n("el-col",{attrs:{span:18,offset:3}},[n("DevicesList")],1)],1)],1)],1)},_=[],x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",size:"mini"},on:{click:function(t){e.connectFormVisible=!0}}},[e._v("连接设备")]),n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData.filter(function(t){return!e.search||t.no.toLowerCase().includes(e.search.toLowerCase())})}},[n("el-table-column",{attrs:{label:"唯一标识符",prop:"serial"}}),n("el-table-column",{attrs:{label:"状态",prop:"state"}}),n("el-table-column",{attrs:{label:"型号",prop:"model"}}),n("el-table-column",{attrs:{label:"设备",prop:"device"}}),n("el-table-column",{attrs:{label:"平台",prop:"product"}}),n("el-table-column",{attrs:{align:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini"},on:{click:function(n){e.handleShell(t.$index,t.row)}}},[e._v("Shell")]),n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(n){e.handleCtrl(t.$index,t.row)}}},[e._v("控制")]),n("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(n){e.handleDelete(t.$index,t.row)}}},[e._v("断开")])]}}])},[n("template",{slot:"header"},[n("el-input",{attrs:{size:"mini",placeholder:"输入关键字搜索"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],2)],1),n("el-dialog",{attrs:{title:"连接设备",visible:e.connectFormVisible,"before-close":e.connectFormCloseEvent},on:{"update:visible":function(t){e.connectFormVisible=t}}},[n("el-form",[n("el-form-item",{attrs:{label:"设备IP"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.connectIp,callback:function(t){e.connectIp=t},expression:"connectIp"}})],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary",loading:e.connectLoading},on:{click:e.connectDevice}},[e._v("连 接")])],1)],1)],1)},k=[],L=function(e){return r["default"].axios.get("/api/devices",{params:e})},E=function(e){return r["default"].axios.get("/api/device/window/size",{params:e})},j=function(e){return r["default"].axios.post("/api/devices/disconnect","ip="+e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},C=function(e){return r["default"].axios.post("/api/devices/connect","ip="+e,{headers:{"Content-Type":"application/x-www-form-urlencoded"}})},$={lists:L,windowSize:E,connect:C,disConnect:j},O={data:function(){return{connectFormVisible:!1,connectLoading:!1,connectIp:"",tableData:[],search:""}},mounted:function(){this.loadList()},methods:{loadList:function(){var e=this;L().then(function(t){e.tableData=t.data})},handleShell:function(e,t){this.$router.push({path:"terminal",query:{serial:t.serial}})},handleDelete:function(e,t){var n=this;j(t.serial).then(function(e){n.$message("连接成功: "+e.response.message),n.loadList()}).catch(function(e){n.$message.error(e.response.message)})},handleCtrl:function(e,t){this.$router.push({path:"control",query:{serial:t.serial}})},connectDevice:function(){var e=this;this.connectLoading=!0,C(this.connectIp).then(function(t){console.log(t.response),e.$message("连接成功: "+t.response.status),e.loadList(),e.connectFormVisible=!1}).catch(function(t){e.$message.error("连接错误，请重试")}).finally(function(){e.connectLoading=!1})},connectFormCloseEvent:function(e){this.connectLoading=!1,e()}}},P=O,T=Object(m["a"])(P,x,k,!1,null,null,null),D=T.exports,I={name:"home",components:{DevicesList:D},methods:{getList:function(){$.lists()}}},U=I,A=(n("56ee"),Object(m["a"])(U,S,_,!1,null,"50e17372",null)),V=A.exports,z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"console",attrs:{id:"terminal"}})},F=[],q=n("f499"),R=n.n(q),B=(n("34ef"),n("9368"),n("59bf")),M=n("c554"),N=n("f105"),W=n("941b");B["Terminal"].applyAddon(W),B["Terminal"].applyAddon(M),B["Terminal"].applyAddon(N);var J=B["Terminal"],K=function(e){return new WebSocket("ws://127.0.0.1:8081/api/device/shell/ws?serial="+e)},G={name:"Console",data:function(){return{terminalSocket:null,term:null,serial:""}},methods:{ab2str:function(e){return String.fromCharCode.apply(null,new Uint8Array(e))}},mounted:function(){var e=this;this.serial=this.$route.query.serial;var t=document.getElementById("terminal");this.terminalSocket=K(this.serial),this.terminalSocket.binaryType="arraybuffer",this.terminalSocket.onopen=function(){e.term=new J({screenKeys:!0,useStyle:!0,cursorBlink:!0,rightClickSelectsWord:!0,rows:40}),e.term.write("\n\n[33mwelcome to "+e.serial+"![0m\r\n\n"),e.term.on("data",function(t){e.terminalSocket.send((new TextEncoder).encode("\0"+t))}),e.term.on("resize",function(t){e.terminalSocket.send((new TextEncoder).encode(""+R()({cols:t.cols,rows:t.rows})))}),e.term.on("title",function(e){document.title=e}),e.term.open(t),e.term.fit(),e.term.toggleFullScreen()},this.terminalSocket.onmessage=function(t){t.data instanceof ArrayBuffer?e.term.write(e.ab2str(t.data)):alert(t.data)},this.terminalSocket.onclose=function(){e.term.write("Session terminated"),e.term.destroy(),e.$route.go(-1)},this.terminalSocket.onerror=function(t){e.term.write("WebSocket Session Error: "+t)}},beforeDestroy:function(){this.terminalSocket.close(),this.term.destroy()}},H=G,Q=(n("8a73"),Object(m["a"])(H,z,F,!1,null,"1d7cd935",null)),X=Q.exports,Y=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-container",[n("el-header",{staticClass:"header"},[e._v(e._s(e.serial))]),n("el-container",[n("el-aside",{attrs:{width:"200px"}},[n("Screencap",{attrs:{serial:e.serial}})],1),n("el-main",[n("el-row",[n("el-col",{attrs:{span:20}})],1)],1)],1)],1)},Z=[],ee=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("img",{style:"width: "+e.width+";height: "+e.height+";",attrs:{src:e.imageSrc}})},te=[],ne={name:"Screencap",data:function(){return{imageSrc:"http://127.0.0.1:8081/api/device/screencap",width:"200px",height:"400px"}},created:function(){setInterval(this.timer,1e4)},methods:{timer:function(){this.imageSrc="http://127.0.0.1:8081/api/device/screencap?channel=shell&serial="+this.serial+"&time="+(new Date).getTime()}},props:{serial:String},mounted:function(){var e=this;E({serial:this.serial}).then(function(t){var n=200*t.data.height,r=n/t.data.width;e.width="200px",e.height=r+"px"}),this.imageSrc="http://127.0.0.1:8081/api/device/screencap?channel=shell&serial="+this.serial}},re=ne,oe=Object(m["a"])(re,ee,te,!1,null,null,null),ie=oe.exports,ae={name:"control",data:function(){return{serial:""}},components:{Screencap:ie},methods:{},created:function(){this.serial=this.$route.query.serial}},ce=ae,le=(n("51b9"),Object(m["a"])(ce,Y,Z,!1,null,"483cde9c",null)),se=le.exports;r["default"].use(y["a"]);var ue=new y["a"]({routes:[{path:"/",name:"home",component:V},{path:"/about",name:"about",component:function(){return n.e("about").then(n.bind(null,"f820"))}},{path:"/terminal",name:"terminal",component:X},{path:"/control",name:"control",component:se}]});r["default"].config.productionTip=!1,new r["default"]({router:ue,render:function(e){return e(v)}}).$mount("#app")},"56ee":function(e,t,n){"use strict";var r=n("fe17"),o=n.n(r);o.a},"64a9":function(e,t,n){},7978:function(e,t,n){},"8a73":function(e,t,n){"use strict";var r=n("1070"),o=n.n(r);o.a},fe17:function(e,t,n){}});
//# sourceMappingURL=app.55abc028.js.map